import{f as W,u as N,g as X,h as Z,j as ee,t as te,i as le,k as C,l as w,m as e,n as se,p as ae,s as re,R as E,q as oe,v as ie,x as ne,y as ue,z as ce,A as F,B as I,C as de,D as he,E as me,F as ve,L as pe,G as ye,H as ge,I as ke,J as M,K as fe,M as H}from"./app-CbLqF3yI.js";const xe=["/","/ai/","/backup/","/bi/echarts-bar.html","/clang/","/clang/cbuild.html","/clang/makefile-cmake-xmake.html","/clang/makefile.html","/clang/musl-gcc.html","/clang/xxd.html","/desktop/quick_run.html","/desktop/screenshot.html","/desktop/windows_remote_desktop.html","/devops/","/devops/buildexe.html","/devops/bytebase.html","/devops/logrotate.html","/devops/redis.html","/devops/setenv.html","/devops/sonarqube.html","/devops/spug.html","/devstd/","/devstd/datastruct.html","/devstd/erpsysarch.html","/docker/","/docker/proxy.html","/docker/registry.html","/docker/volumes.html","/etl/","/etl/kettle.html","/etl/kettle_conf.html","/etl/kettle_issue.html","/etl/kettle_select.html","/etl/kettle_spoon.html","/etl/kettle_usage.html","/git/","/git/gitflow.html","/git/gittag.html","/golang/","/golang/cross_build.html","/golang/dialog_file.html","/golang/httpproxy_svr.html","/linux/","/linux/disk.html","/linux/ssh.html","/java/","/java/conf.html","/java/envformvn.html","/java/jwt.html","/java/mvn.html","/java/nexus.html","/net/","/net/httpheader.html","/net/netlayer.html","/nginx/","/nginx/location.html","/nginx/nginxui.html","/nginx/realip.html","/nodejs/","/nodejs/docs.html","/nodejs/n8n.html","/nodejs/nvm.html","/oa/weaverconf.html","/ruby/jekyll.html","/sql/add_index.html","/ai/prompt/","/ai/prompt/arch.html","/ai/prompt/role.html","/ai/prompt/sitedown.html","/desktop/regedit/ctxmenu.html","/devops/gitlab/","/devops/gitlab/issue.html","/devops/gitlab/runner.html","/devops/grafana/","/devops/grafana/dashboards.html","/devops/grafana/loki_nginx.html","/devops/grafana/node_exporter.html","/devops/grafana/prometheus.html","/devops/kestra/","/devops/kestra/config.html","/devops/kestra/errors.html","/devops/kestra/flowable.html","/devops/kestra/inoutputs.html","/devops/kestra/namespace.html","/devops/kestra/scripts.html","/devops/kestra/triggers.html","/devops/taiga/start_docker.html","/devops/taiga/taiga.html","/devops/unifyauth/","/devops/unifyauth/oauth2.html","/devops/workflows/","/docker/harbor/","/linux/shell/","/linux/shell/if.html","/linux/systemd/","/linux/systemd/journald.html","/python/odoo/jwt.html","/python/odoo/view_data.html","/devops/grafana/promtail/","/404.html","/bi/","/desktop/","/oa/","/ruby/","/sql/","/desktop/regedit/","/devops/taiga/","/python/odoo/","/python/"],be="SLIMSEARCH_QUERY_HISTORY",g=M(be,[]),we=()=>{const{queryHistoryCount:a}=H;return{enabled:a>0,queryHistories:g,addQueryHistory:n=>{g.value=Array.from(new Set([n,...g.value.slice(0,a-1)]))},removeQueryHistory:n=>{g.value=[...g.value.slice(0,n),...g.value.slice(n+1)]}}},L=a=>xe[a.id]+("anchor"in a?`#${a.anchor}`:""),He="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:T}=H,k=M(He,[]),_e=()=>({enabled:T>0,resultHistories:k,addResultHistory:i=>{{const n={link:L(i),display:i.display};"header"in i&&(n.header=i.header),k.value=[n,...k.value.slice(0,T-1)]}},removeResultHistory:i=>{k.value=[...k.value.slice(0,i),...k.value.slice(i+1)]}}),qe=a=>{const{page:i,routeLocale:n}=de(),_=he(),r=C(0),f=w(()=>r.value>0),d=me([]);return ve(()=>{const{search:q,terminate:v}=pe(),x=ge(p=>{const{resultsFilter:j=s=>s,querySplitter:y,suggestionsFilter:D,...o}=_.value;p?(r.value+=1,q(p,n.value,o).then(s=>j(s,p,n.value,i.value)).then(s=>{r.value-=1,d.value=s}).catch(s=>{console.warn(s),r.value-=1,r.value||(d.value=[])})):d.value=[]},H.searchDelay-H.suggestDelay,{maxWait:5e3});ye([a,n],([p])=>x(p.join(" "))),ke(()=>{v()})}),{isSearching:f,results:d}};var Re=W({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:i}){const n=N(),_=X(),r=Z(ee),{addQueryHistory:f,queryHistories:d,removeQueryHistory:q}=we(),{resultHistories:v,addResultHistory:x,removeResultHistory:p}=_e(),j=te(a,"queries"),{results:y,isSearching:D}=qe(j),o=le({isQuery:!0,index:0}),s=C(0),h=C(0),$=w(()=>d.value.length>0||v.value.length>0),R=w(()=>y.value.length>0),Q=w(()=>y.value[s.value]||null),U=()=>{const{isQuery:t,index:l}=o;l===0?(o.isQuery=!t,o.index=t?v.value.length-1:d.value.length-1):o.index=l-1},O=()=>{const{isQuery:t,index:l}=o;l===(t?d.value.length-1:v.value.length-1)?(o.isQuery=!t,o.index=0):o.index=l+1},P=()=>{s.value=s.value>0?s.value-1:y.value.length-1,h.value=Q.value.contents.length-1},Y=()=>{s.value=s.value<y.value.length-1?s.value+1:0,h.value=0},B=()=>{h.value<Q.value.contents.length-1?h.value+=1:Y()},z=()=>{h.value>0?h.value-=1:P()},S=t=>t.map(l=>fe(l)?l:e(l[0],l[1])),G=t=>{if(t.type==="customField"){const l=ue[t.index]||"$content",[m,u=""]=ce(l)?l[_.value].split("$content"):l.split("$content");return t.display.map(c=>e("div",S([m,...c,u])))}return t.display.map(l=>e("div",S(l)))},b=()=>{s.value=0,h.value=0,i("updateQuery",""),i("close")},J=()=>e("div",{class:"slimsearch-records"},e("div",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},r.value.queryHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},d.value.map((t,l)=>{const m=o.isQuery&&o.index===l;return e("li",{class:["slimsearch-record-matches",{active:m}],role:"option","aria-selected":m,onClick:()=>{i("updateQuery",t)}},e("div",[e(F,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},t),e("button",{type:"button",class:"slimsearch-remove-icon",title:r.value.remove,"aria-label":r.value.remove,innerHTML:I,onClick:u=>{u.preventDefault(),u.stopPropagation(),q(l)}})]))}))])),K=()=>e("ul",{class:"slimsearch-records"},e("li",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},r.value.resultHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},v.value.map((t,l)=>{const m=!o.isQuery&&o.index===l;return e("li",{class:["slimsearch-record-matches",{active:m}],role:"option","aria-selected":m},e(E,{to:t.link,onClick:()=>{b()}},()=>[e(F,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[t.header?e("div",{class:"slimsearch-record-content-header"},t.header):null,e("div",t.display.map(u=>S(u)).flat())]),e("button",{type:"button",class:"slimsearch-remove-icon",title:r.value.remove,"aria-label":r.value.remove,innerHTML:I,onClick:u=>{u.preventDefault(),u.stopPropagation(),p(l)}})]))}))]));return se("keydown",t=>{if(a.isFocusing){if(R.value){if(t.key==="ArrowUp")z();else if(t.key==="ArrowDown")B();else if(t.key==="Enter"){const l=Q.value.contents[h.value];f(a.queries.join(" ")),x(l),n.push(L(l)),b()}}else if(t.key==="ArrowUp")U();else if(t.key==="ArrowDown")O();else if(t.key==="Enter"){const{index:l}=o;o.isQuery?(t.preventDefault(),i("updateQuery",d.value[l])):(n.push(v.value[l].link),b())}}}),ae([s,h],()=>{document.querySelector(".slimsearch-record.active .slimsearch-record-matches.active")?.scrollIntoView(!1)},{flush:"post"}),()=>e("div",{id:"slimsearch-results",class:["slimsearch-result-wrapper",{empty:a.queries.length?!R.value:!$.value}]},a.queries.length?D.value?e(re,{hint:r.value.searching}):R.value?e("div",{class:"slimsearch-records",role:"listbox","aria-labeledby":"slimsearch-label"},y.value.map(({title:t,contents:l},m)=>{const u=s.value===m;return e("div",{class:["slimsearch-record",{active:u}],role:"group","aria-selected":u},[e("div",{class:"slimsearch-record-title"},t||r.value.defaultTitle),e("ul",{class:"slimsearch-record-contents"},l.map((c,V)=>{const A=u&&h.value===V;return e("li",{class:["slimsearch-record-matches",{active:A}],role:"option","aria-selected":A},e(E,{to:L(c),onClick:()=>{f(a.queries.join(" ")),x(c),b()}},()=>[c.type==="text"?null:e(c.type==="title"?oe:c.type==="heading"?ie:ne,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[c.type==="text"&&c.header?e("div",{class:"slimsearch-record-content-header"},c.header):null,e("div",G(c))])]))}))])})):r.value.emptyResult:$.value?[J(),K()]:r.value.emptyHistory)}});export{Re as default};
